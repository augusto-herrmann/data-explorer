(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{305:function(e,t,r){},457:function(e,t){},467:function(e){e.exports={id:1,specType:"table",resources:[{name:"test",_values:[["x1a","x1b","x1c","x1d"],[1,2,3,4],[2,3,4,5],[3,4,5,6]],data:[["x1a","x1b","x1c","x1d"],[1,2,3,4],[2,3,4,5],[3,4,5,6]]}]}},474:function(e,t,r){e.exports=r(909)},595:function(e,t){},597:function(e,t){},629:function(e,t){},630:function(e,t){},814:function(e,t,r){var a={"./geojson.json":436,"./table-schema.json":815,"./topojson.json":437};function n(e){var t=c(e);return r(t)}function c(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=c,e.exports=n,n.id=814},899:function(e,t){},900:function(e,t){},904:function(e,t){},905:function(e,t){},909:function(e,t,r){"use strict";r.r(t);var a=r(5),n=r.n(a),c=r(130),o=r.n(c),i=r(221),s=r(115),u=r(459),l=r(460),d=function(e){if(!e)return{};switch((e.views||[]).length){case 1:return e.views[0];case 2:return e.views[1];default:return function(e){try{return{resources:[{schema:e.resources[0].schema}]}}catch(t){return{}}}(e)}},p=function(e){return JSON.parse(JSON.stringify(e))},f=Object(s.combineReducers)({dataViewBuilder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case"DATA_VIEW_BUILDER_ACTION":default:return e}},filterUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case"FILTER_UI_ACTION":return console.log("reducer",e),{test:1*(e.test||0)+1};default:return e}},sharedState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DATA_VIEW_BUILDER_ACTION":var r=p(e.datapackage);return 1===r.views.length&&r.views.unshift(t.payload),r.views.length>1&&(r.views[0]=t.payload),Object.assign(p(e),{datapackage:r});case"FILTER_UI_ACTION":return{datapackage:{foo:"bar"},loadedData:{hello:"world"}};case"FETCH_DATA_BEGIN":return Object.assign({},e,{loading:!0});case"FETCH_DATA_SUCCESS":return Object.assign({},e,{loading:!1,error:!1,datapackage:t.payload.datapackage});case"FETCH_DATA_FAILURE":return Object.assign({},e,{loading:!1,error:!0,errorBody:t.payload});default:return e}}}),b={dataViewBuilder:{},filterUI:{},sharedState:{loading:!1,datapackage:{},loadedData:{}}};r(305);var v=r(29),h=function(e){return n.a.createElement("div",{className:"text-center"},n.a.createElement("h2",{className:"text-2xl"},"Filter UI"),n.a.createElement("button",{className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-full m-2",onClick:function(t){e.fetchDataAction()}},"Fetch Data"))},m=r(461),g=r.n(m),w=r(462),y=r.n(w),O=function(e){var t=e.datapackage.views;return n.a.createElement(g.a,{loaded:!e.loading},n.a.createElement("div",null,t.map(function(e){return n.a.createElement(y.a,{key:Math.random(),datapackage:{views:[e]}})})))},x=(r(467),r(468)),E=r(65),k=r.n(E),j=r(166),D=r(301),A=r(472),_=r(392);function I(e){try{return JSON.parse(e)}catch(t){return e}}function N(e){return e.views.map(function(t){return D.compileView(t,e)})}var T=function(){var e=Object(j.a)(k.a.mark(function e(t){var r,a,n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=I(t),a=["csv","tsv","dsv","xls","xlsx"],e.prev=2,e.next=5,A.Dataset.load(r);case 5:return n=e.sent,e.next=8,Promise.all(n.resources.map(function(){var e=Object(j.a)(k.a.mark(function e(t){var r,n,c,o,i,s;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("FileInline"!==t.displayName){e.next=4;break}return e.abrupt("return");case 4:if(!t.descriptor.path||!t.descriptor.path.includes("datastore_search")){e.next=17;break}return e.next=7,fetch(t.descriptor.path);case 7:if((r=e.sent).ok){e.next=11;break}return t.descriptor.unavailable=!0,e.abrupt("return");case 11:return e.next=13,r.json();case 13:n=e.sent,t.descriptor.data=n.result.records,e.next=58;break;case 17:if("FileRemote"!==t.displayName||!a.includes(t.descriptor.format)){e.next=34;break}return e.prev=18,e.next=21,t.rows({size:100,keyed:!0});case 21:return c=e.sent,e.next=24,_(c);case 24:(o=e.sent).length>0?t.descriptor.data=o:t.descriptor.unavailable=!0,e.next=32;break;case 28:e.prev=28,e.t0=e.catch(18),console.log(e.t0),t.descriptor.unavailable=!0;case 32:e.next=58;break;case 34:if(!t.descriptor.format.toLowerCase().includes("json")){e.next=53;break}return e.next=37,fetch(t.descriptor.path);case 37:if((i=e.sent).ok){e.next=41;break}return t.descriptor.unavailable=!0,e.abrupt("return");case 41:return e.next=43,i.json();case 43:if(s=e.sent,!["Feature","FeatureCollection","Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection"].includes(s.type)){e.next=49;break}t.descriptor.data=s,e.next=51;break;case 49:return t.descriptor.unavailable=!0,e.abrupt("return");case 51:e.next=58;break;case 53:if("pdf"!==t.descriptor.format.toLowerCase()){e.next=57;break}return e.abrupt("return");case 57:t.descriptor.unavailable=!0;case 58:case"end":return e.stop()}},e,null,[[18,28]])}));return function(t){return e.apply(this,arguments)}}()));case 8:return e.abrupt("return",N(n.descriptor));case 11:return e.prev=11,e.t0=e.catch(2),console.warn("Failed to load a Dataset from provided datapackage id\n"+e.t0),e.abrupt("return",r);case 15:case"end":return e.stop()}},e,null,[[2,11]])}));return function(t){return e.apply(this,arguments)}}();function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(r,!0).forEach(function(t){Object(v.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var P=function(){return{type:"FETCH_DATA_BEGIN"}},F=function(e){return{type:"FETCH_DATA_SUCCESS",payload:C({},e)}};function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}var B=Object(i.b)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(r,!0).forEach(function(t){Object(v.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e)},function(e){return{filterUIAction:function(){return e(function(e){e({type:"FILTER_UI_ACTION"})})},fetchDataAction:function(t){return e(function(e){return function(){var t=Object(j.a)(k.a.mark(function t(r){var a;return k.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r(P()),t.next=3,T(e.datapackage);case 3:a=t.sent,r(F({datapackage:{views:a}}));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(t))},dataViewBuilderAction:function(t){return e(function(e){return function(t){t({type:"DATA_VIEW_BUILDER_ACTION",payload:e})}}(t))}}})(function(e){return Object(a.useEffect)(function(){var t={datapackage:e.sharedState.datapackage};e.fetchDataAction(t)},[]),n.a.createElement("div",{className:"text-center ml-6"},n.a.createElement("header",null,n.a.createElement("div",{className:"container"},n.a.createElement("h1",{className:"text-3xl"},"Data Explorer"))),n.a.createElement("div",{className:"container py-6 bg-pink-100"},n.a.createElement("div",{className:""},n.a.createElement(h,e))),n.a.createElement("div",{className:"container flex py-6"},n.a.createElement("div",{className:"w-3/4 p-4 mr-4 overflow-x-auto border-r-2"},n.a.createElement(O,e.sharedState)),n.a.createElement("div",{className:"w-1/4 p-4 mr-4"},n.a.createElement(x.ChartBuilder,{view:d(e.sharedState.datapackage),dataViewBuilderAction:e.dataViewBuilderAction}))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var L,R=function(e){try{return JSON.parse(e)}catch(t){return console.error(t),e}}(window.DP_ID);o.a.render(n.a.createElement(i.a,{store:(L={sharedState:{datapackage:R}},Object(s.createStore)(f,Object.assign({},b,L),Object(u.composeWithDevTools)(Object(s.applyMiddleware)(l.a))))},n.a.createElement(B,null)),document.getElementById("data-explorer")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[474,1,2]]]);
//# sourceMappingURL=main.9855339d.chunk.js.map